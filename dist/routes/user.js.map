{"version":3,"sources":["../../src/routes/user.js"],"names":["router","dal","DALController","userColl","mongoose","model","userModel","findAll","filter","sort","limit","coll","res","then","docs","status","send","err","console","log","message","get","req","render","params","id","users","put","findOneAndUpdate","post","body","newUser","save","forEach","doc","_id","username","text","module","exports"],"mappings":"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","sourcesContent":["import {Router} from 'express'\r\nimport mongoose from 'mongoose'\r\nimport userModel from '../models'\r\nimport {DALController} from '../controller'\r\n\r\nconst router = Router()\r\nconst dal = new DALController()\r\nconst userColl = mongoose.model('user', userModel)\r\n\r\nfunction findAll(filter, sort, limit, coll, res){\r\n  dal.findAll(filter, sort, limit, coll)\r\n  .then((docs) => {\r\n    // console.log(docs)\r\n    res.status(200).send(docs)\r\n  })\r\n  .catch((err)=>{\r\n    console.log(err)\r\n    res.status(500).send(err.message)\r\n  })\r\n}\r\n\r\nrouter.get('/', (req, res) => {\r\n  findAll({}, {'_id': 'desc'}, null, userColl, res)\r\n})\r\n\r\nrouter.get('/test', (req,res) => res.render('index'))\r\n\r\nrouter.get('/:id', (req, res) => {\r\n  // findAll({'_id': req.params.id}, {'_id': 'desc'}, 1, userColl, res)\r\n  dal.findAll({'_id': req.params.id}, {'_id': 'desc'}, 1, userColl)\r\n  .then((docs) => {\r\n    console.log(docs)\r\n    res.render('all', {users: docs})\r\n  })\r\n  .catch((err)=>{\r\n    console.log(err)\r\n    res.status(500).send(err.message)\r\n  })\r\n})\r\n\r\n\r\nrouter.put('/:id', (req, res) => {\r\n  dal.findOneAndUpdate({'_id': req.params.id}, {'name': 'test deprecate'}, {'new': true}, userColl)\r\n  .then((docs) => {\r\n    console.log(docs)\r\n    res.status(200).send(docs)\r\n  })\r\n  .catch((err)=>{\r\n    console.log(err)\r\n    res.status(500).send(err.message)\r\n  })\r\n})\r\n\r\nrouter.post('/', (req, res) => {\r\n  console.log(req.body)\r\n  const newUser = new userColl(req.body)\r\n\r\n  dal.save(newUser)\r\n  .then((docs) => {\r\n    console.log(docs)\r\n    res.status(200).send(docs)\r\n  })\r\n  .catch((err)=>{\r\n    console.log(err)\r\n    res.status(500).send(err.message)\r\n  })\r\n})\r\n\r\nrouter.post('/getUserById', (req, res) => {\r\n  console.log(req.body)\r\n  dal.findAll({'_id': req.body.id}, {'_id': 'desc'}, null, userColl)\r\n  .then((docs) => {\r\n    console.log(docs)\r\n    let users = '<table><thead><td>id</td><td>name</td><td>text</td></thead><tbody>'\r\n    docs.forEach(doc => {\r\n      users += '<tr><td>'+doc._id+'</td><td>'+doc.username+'</td><td>'+doc.text+'</td></tr>'\r\n    });\r\n    users += '</tbody></table>'\r\n    res.status(200).send(users)\r\n  })\r\n  .catch((err)=>{\r\n    console.log(err)\r\n    res.status(500).send(err.message)\r\n  })\r\n})\r\n\r\n\r\n\r\nmodule.exports = router"],"file":"user.js"}